<div class="min-h-screen flex flex-col bg-slate-100 relative">

    <!-- NAVBAR -->
    <nav class="sticky top-0 z-50 bg-black border-b border-black/30">
        <div class="max-w-[90%] mx-auto px-6 h-20 flex items-center justify-between">

            <!-- LOGO -->
            <a routerLink="/" (click)="goHome()" class="text-2xl font-semibold bg-linear-to-r from-gray-100 to-gray-300
                bg-clip-text text-transparent hover:scale-105 transition cursor-pointer">
                Linksys Store
            </a>

            <!-- LINKS DESKTOP -->
            <div class="hidden md:flex gap-10">
                <a routerLink="/" (click)="goHome()"
                    class="text-gray-100 font-medium hover:text-green-400 transition cursor-pointer">
                    Inicio
                </a>

                <a routerLink="/products" (click)="goProducts()"
                    class="text-gray-100 font-medium hover:text-green-400 transition cursor-pointer">
                    Productos
                </a>
            </div>

            <!-- ACTIONS -->
            <div class="flex items-center gap-6">

                <!-- CART -->
                <button type="button" title="Carrito" (click)="goCart()"
                    class="relative p-3 rounded-full hover:bg-white/20 transition">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="9" cy="21" r="1" />
                        <circle cx="20" cy="21" r="1" />
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
                    </svg>

                    @if (cartService.count() > 0) {
                    <span class="absolute -top-1 -right-1 text-[10px] font-bold text-white
                        bg-linear-to-r from-blue-700 to-sky-400
                        px-1.5 py-0.5 rounded-full border border-white">
                        {{ cartService.count() }}
                    </span>
                    }
                </button>

                <!-- USER AUTH -->
                @if (authService.currentUser()) {

                <div class="relative">

                    <!-- USER BUTTON -->
                    <button type="button" title="Cuenta" (click)="toggleUserMenu()" class="flex items-center gap-2 px-3 py-2 border border-white/40 rounded-lg
                        text-white hover:bg-white hover:text-black transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="12" cy="7" r="4" />
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                        </svg>

                        <span class="hidden lg:inline truncate max-w-35">
                            {{ authService.currentUser()?.email }}
                        </span>
                    </button>

                    <!-- USER DROPDOWN -->
                    @if (userMenuOpen()) {
                    <div class="absolute right-0 mt-2 w-60 bg-white rounded-xl shadow-xl border z-50 overflow-hidden">
                        <div class="px-4 py-3 flex justify-between items-center text-sm font-semibold">
                            <span>
                                {{ authService.currentUser()?.fullName || authService.currentUser()?.email }}
                            </span>

                            @if (authService.currentUser()?.role === 'admin') {
                            <span class="text-[10px] bg-black text-amber-500 px-2 py-0.5 rounded-full uppercase">
                                Admin
                            </span>
                            }
                        </div>

                        <hr />

                        <button type="button" routerLink="/profile" (click)="closeUserMenu()"
                            class="w-full text-left px-4 py-3 text-sm hover:bg-slate-100 transition">
                            Mi Perfil
                        </button>

                        <button type="button" routerLink="/orders" (click)="closeUserMenu()"
                            class="w-full text-left px-4 py-3 text-sm hover:bg-slate-100 transition">
                            Mis Pedidos
                        </button>

                        @if (authService.currentUser()?.role === 'admin') {
                        <hr />
                        <button type="button" routerLink="/admin" (click)="closeUserMenu()"
                            class="w-full text-left px-4 py-3 text-sm font-bold hover:bg-slate-100 transition">
                            Panel de Administrador
                        </button>
                        }

                        <hr />

                        <button type="button" (click)="logout()"
                            class="w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition">
                            Cerrar Sesión
                        </button>
                    </div>
                    }
                </div>

                } @else {

                <!-- LOGIN -->
                <button type="button" (click)="goLogin()" class="flex items-center gap-2 px-4 py-2 rounded-lg
                bg-linear-to-r from-blue-700 to-indigo-600
                text-white font-semibold hover:scale-105 transition">
                    Iniciar Sesión
                </button>

                }

                <!-- MOBILE MENU BUTTON -->
                <button type="button" (click)="toggleMobileMenu()"
                    class="md:hidden p-2 rounded-lg hover:bg-white/20 text-white transition" aria-label="Menú móvil">
                    ☰
                </button>
            </div>
        </div>

        <!-- MOBILE MENU -->
        @if (mobileMenuOpen()) {
        <div class="md:hidden grid grid-cols-3 gap-2 p-4 bg-black/90 border-t border-blue-600">

            <button type="button" (click)="goHome()"
                class="bg-white text-blue-700 rounded-lg py-3 text-xs font-semibold">
                Inicio
            </button>

            <button type="button" (click)="goProducts()"
                class="bg-white text-blue-700 rounded-lg py-3 text-xs font-semibold">
                Productos
            </button>

            <button type="button" (click)="goCart()"
                class="bg-white text-blue-700 rounded-lg py-3 text-xs font-semibold">
                Carrito
            </button>

        </div>
        }
    </nav>

    <!-- ROUTER CONTENT -->
    <main class="grow">
        <router-outlet></router-outlet>
    </main>

    <!-- FOOTER -->
    <footer class="bg-black/90 text-gray-100 pt-16 pb-10">
        <div class="max-w-5xl mx-auto px-6 grid gap-10 md:grid-cols-4">

            <div>
                <h3 class="text-xl font-bold bg-linear-to-r from-blue-600 to-slate-900
                    bg-clip-text text-transparent">
                    Linksys Store
                </h3>
                <p class="text-sm mt-2">
                    Tu destino premium para tecnología de vanguardia.
                </p>
            </div>

            <div>
                <h4 class="font-semibold mb-3">Explorar</h4>
                <ul class="space-y-2 text-sm">
                    <li><button type="button" (click)="goProducts()">Productos</button></li>
                    <li><button type="button">Categorías</button></li>
                    <li><button type="button">Nuevos lanzamientos</button></li>
                </ul>
            </div>

            <div>
                <h4 class="font-semibold mb-3">Empresa</h4>
                <ul class="space-y-2 text-sm">
                    <li><button type="button">Sobre Nosotros</button></li>
                    <li><button type="button">Contacto</button></li>
                    <li><button type="button">Blog</button></li>
                </ul>
            </div>

            <div>
                <h4 class="font-semibold mb-3">Legal</h4>
                <ul class="space-y-2 text-sm">
                    <li><button type="button">Privacidad</button></li>
                    <li><button type="button">Términos</button></li>
                </ul>
            </div>
        </div>

        <div class="mt-12 pt-6 border-t border-white/20 text-center text-sm text-blue-400">
            © 2026 Linksys Store. Todos los derechos reservados.
        </div>
    </footer>

    <!-- CART SIDEBAR -->
    <app-cart-sidebar />

</div>