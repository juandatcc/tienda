<div class="card-container" [class.out-of-stock]="product.stock <= 0">
    <!-- Image -->
    <div class="image-wrapper">
        <img *ngIf="product.imageUrl" [src]="product.imageUrl" [alt]="product.name" class="product-image"
            (error)="onImageError($event)">
        <div *ngIf="!product.imageUrl || imageError" class="image-placeholder">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                <circle cx="8.5" cy="8.5" r="1.5" />
                <polyline points="21 15 16 10 5 21" />
            </svg>
        </div>
        <div class="image-overlay"></div>

        <!-- Stock Badge -->
        <div class="stock-badge-wrapper">
            <span *ngIf="product.stock >= 1" class="available-badge">
                ✓ Disponible
            </span>
            <span *ngIf="product.stock <= 0" class="unavailable-badge">
                ✗ No Disponible
            </span>
        </div>

        <!-- Quick Action Button -->
        <div class="quick-action-wrapper">
            <button (click)="addToCart($event)" class="btn-add-cart" [disabled]="product.stock <= 0"
                title="Añadir al carrito">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="8" cy="21" r="1" />
                    <circle cx="19" cy="21" r="1" />
                    <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12" />
                    <path d="M12 10v6" />
                    <path d="M9 13h6" />
                </svg>
            </button>
        </div>
    </div>

    <!-- Content -->
    <div class="card-content">
        <h3 class="card-title">
            <a [routerLink]="['/products', product.id]">
                {{ product.name }}
            </a>
        </h3>
        <p class="card-description">{{ product.description }}</p>

        <div class="card-footer">
            <div class="price-wrapper">
                <span class="price-label">Precio</span>
                <span class="price-text">{{ product.price | priceFormat }}</span>
            </div>
            <button [routerLink]="product.stock > 0 ? ['/products', product.id] : null" class="details-button"
                [disabled]="product.stock <= 0">
                <span *ngIf="product.stock > 0">Ver Detalles</span>
                <span *ngIf="product.stock <= 0">Agotado</span>
            </button>
        </div>
    </div>
</div>